"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[361],{361:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var s=r(43),a=r(213);var i=r(579);const c=function(){const[e,t]=(0,s.useState)(""),[r,c]=(0,s.useState)("all"),[n,l]=(0,s.useState)({krwList:[],btcList:[],usdtList:[]}),[o,d]=(0,s.useState)(0);(0,s.useEffect)((()=>{(async()=>{try{return(await a.A.get("/api/upbit/priceList")).data}catch(e){throw console.error("Failed to fetch Upbit list:",e),e}})().then((t=>{p(t,e,r)}))}),[e,r]),(0,s.useEffect)((()=>{const e=window.location.protocol+"//"+window.location.host,t=new EventSource(e+"/api/sse/price"),r=setInterval((()=>{fetch(e+"/api/sse/ping").catch((e=>console.error("Ping error: ",e)))}),1e4);return t.addEventListener("price",(e=>{let t=JSON.parse(e.data);"KRW-BTC"===t.code&&d(t.trade_price),l((e=>{const r=e.krwList.map((e=>{if(e.market===t.code){const r=Number(e.price),s=Number(t.trade_price),a=s>r?"price-up change":"price-down change";return setTimeout((()=>{l((e=>({...e,krwList:e.krwList.map((e=>e.market===t.code?{...e,priceChangeClass:a.replace(" change","")}:e))})))}),300),{...e,price:h(s),priceChangeClass:a}}return e}));return{...e,krwList:r}}))})),()=>{console.log("Closing SSE connection"),t.close(),clearInterval(r)}}),[]);const h=e=>{let t=Number(e);if(t>1e3)return Math.floor(t).toLocaleString();if(t<=1e3&&t>1)return t.toFixed(1).toString();if(t<1){return t.toFixed(10).replace(/\.?0+$/,"")}return isNaN(t)?"Price not available":t.toString()},p=(e,t,r)=>{let s=[],a=[],i=[];const c=e.COIN,n=e.PRICE;for(let l in c){const e=c[l].market;for(let t in n)n[t].market===e&&(c[l].price=h(n[t].trade_price),c[l].prev_closing_price=h(n[t].prev_closing_price),c[l].priceChangeClass=m(n[t].trade_price,n[t].prev_closing_price),"KRW-BTC"==e&&d(c[l].price));e.startsWith("KRW-")&&c[l].korean_name.toLowerCase().includes(t)&&("all"===r||"krw"===r)?s.push(c[l]):e.startsWith("BTC-")&&c[l].korean_name.toLowerCase().includes(t)&&("all"===r||"btc"===r)?a.push(c[l]):!c[l].korean_name.toLowerCase().includes(t)||"all"!==r&&"usdt"!==r||i.push(c[l])}l({krwList:s,btcList:a,usdtList:i})},m=(e,t)=>e>t?"price-up":e<t?"price-down":"price-stable";return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"search-and-buttons",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:()=>alert("\uc5b4\ud734 \ubc14\ubcf4 \u3149\u3149"),children:"\ub204\ub974\uba74 \ubc14\ubcf4"}),(0,i.jsx)("button",{onClick:()=>alert("\ub098\ud63c\uc790 \ub178\ub294\uc911"),children:"\uc5ec\uae30\ub2e4 \ubb34\uc2a8\uae30\ub2a5\ub2ec\uc9c0"}),(0,i.jsx)("button",{onClick:()=>alert("Button 3 Clicked!"),children:"Button 3"})]}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,i.jsx)("input",{type:"text",placeholder:"Search by Korean Name...",value:e,onChange:e=>{const s=e.target.value.toLowerCase();t(s),p(n,s,r)}}),(0,i.jsxs)("select",{value:r,onChange:t=>{const r=t.target.value;c(r),p(n,e,r)},children:[(0,i.jsx)("option",{value:"all",children:"All Markets"}),(0,i.jsx)("option",{value:"krw",children:"KRW Market"}),(0,i.jsx)("option",{value:"btc",children:"BTC Market"}),(0,i.jsx)("option",{value:"usdt",children:"USDT Market"})]})]})]}),(0,i.jsxs)("div",{className:"market-lists",children:[(0,i.jsxs)("div",{className:"market-list",children:[(0,i.jsxs)("h3",{children:["KRW Market : ",n.krwList.length," \ud56d\ubaa9"]}),n.krwList.map(((e,t)=>(0,i.jsxs)("div",{className:`market-item ${e.priceChangeClass}`,children:[(0,i.jsxs)("div",{className:"market-name",children:[e.korean_name," (",e.english_name,")"]}),(0,i.jsx)("div",{className:"market-code",children:e.market}),(0,i.jsx)("div",{className:"market-price",children:e.price?e.price+" \uc6d0":"Price not available"})]},t)))]}),(0,i.jsxs)("div",{className:"market-list",children:[(0,i.jsxs)("h3",{children:["BTC Market : ",n.btcList.length," \ud56d\ubaa9"]}),n.btcList.map(((e,t)=>(0,i.jsxs)("div",{className:`market-item ${e.priceChangeClass}`,children:[(0,i.jsxs)("div",{className:"market-name",children:[e.korean_name," (",e.english_name,")"]}),(0,i.jsx)("div",{className:"market-code",children:e.market}),(0,i.jsxs)("div",{className:"market-price",children:[e.price?e.price+" \uc6d0":"Price not available",(0,i.jsx)("div",{style:{fontSize:"10px",color:"midnightblue"},children:(o*e.price).toLocaleString()})]})]},t)))]}),(0,i.jsxs)("div",{className:"market-list",children:[(0,i.jsxs)("h3",{children:["USDT Market : ",n.usdtList.length," \ud56d\ubaa9"]}),n.usdtList.map(((e,t)=>(0,i.jsxs)("div",{className:`market-item ${e.priceChangeClass}`,children:[(0,i.jsxs)("div",{className:"market-name",children:[e.korean_name," (",e.english_name,")"]}),(0,i.jsx)("div",{className:"market-code",children:e.market}),(0,i.jsx)("div",{className:"market-price",children:e.price?e.price:"Price not available"})]},t)))]})]})]})}}}]);
//# sourceMappingURL=361.0eed0d93.chunk.js.map